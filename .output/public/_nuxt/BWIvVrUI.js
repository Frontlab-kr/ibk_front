import{d as e,r as n,n as t,k as l,A as a,w as o,a1 as s,o as u,c as r,F as i,f as c,G as d,s as m,x as v,h as f,t as p}from"./BL-uwq_y.js";function w({columns:e,columnWidth:n,emit:t,gap:l,items:a,maxColumns:o,minColumns:s,nextTick:u,onBeforeUnmount:r,onMounted:i,rtl:c,scrollContainer:d,ssrColumns:m,vue:v,wall:f,watch:p}){function w(e,n,t,l){const a=h(t);return l+n+a<=e?w(e,n,t+1,l+n+a):t}function h(e){const t=Array.isArray(n.value)?n.value:[n.value];return t[e%t.length]}function y(){const e=function(e){const n=null==s?void 0:s.value;return n&&e<n?n:e}(function(e){const n=null==o?void 0:o.value;return n&&e>n?n:e}(w(f.value.getBoundingClientRect().width,l.value,0,-l.value)));return e>0?e:1}if(m.value>0){const n=g(m.value);a.value.forEach(((e,t)=>n[t%m.value].push(t))),e.value=n}let x=0;async function C(n,t){if(n>=a.value.length||(await u(),x!==t))return;const l=[...f.value.children];c.value&&l.reverse();const o=l.reduce(((e,n)=>n.getBoundingClientRect().height<e.getBoundingClientRect().height?n:e));e.value[+o.dataset.index].push(n),await C(n+1,t)}async function k(n=!1){const l=y();if(e.value.length===l&&!n)return void t(2===v?"redraw-skip":"redrawSkip");e.value=g(l);const a=null==d?void 0:d.value,o=a?a.scrollTop:window.scrollY;await C(0,++x),a?a.scrollBy({top:o-a.scrollTop}):window.scrollTo({top:o}),t("redraw")}const T=typeof ResizeObserver>"u"?void 0:new ResizeObserver(function(e,n){let t;return(...l)=>{void 0!==t&&clearTimeout(t),t=setTimeout((()=>e(...l)),n)}}((()=>k())));return i((()=>{k(),null==T||T.observe(f.value)})),r((()=>null==T?void 0:T.unobserve(f.value))),p([a,c],(()=>k(!0))),p([n,l,s,o],(()=>k())),{getColumnWidthTarget:h}}function g(e){return Array.from({length:e}).map((()=>[]))}const h=["data-index"],y=e({__name:"masonry-wall",props:{columnWidth:{default:400},items:{},gap:{default:0},rtl:{type:Boolean,default:!1},ssrColumns:{default:0},scrollContainer:{default:null},minColumns:{default:1},maxColumns:{},keyMapper:{}},emits:["redraw","redrawSkip"],setup(e,{emit:g}){const y=e,x=g,C=n([]),k=n(),{getColumnWidthTarget:T}=w({columns:C,emit:x,nextTick:t,onBeforeUnmount:l,onMounted:a,vue:3,wall:k,watch:o,...s(y)});return(e,n)=>(u(),r("div",{ref_key:"wall",ref:k,class:"masonry-wall",style:d({display:"flex",gap:`${e.gap}px`})},[(u(!0),r(i,null,c(C.value,((n,t)=>(u(),r("div",{key:t,class:"masonry-column","data-index":t,style:d({display:"flex","flex-basis":`${m(T)(t)}px`,"flex-direction":"column","flex-grow":1,gap:`${e.gap}px`,height:["-webkit-max-content","-moz-max-content","max-content"],"min-width":0})},[(u(!0),r(i,null,c(n,((n,l)=>{var a;return u(),r("div",{key:(null==(a=e.keyMapper)?void 0:a.call(e,e.items[n],t,l,n))??n,class:"masonry-item"},[v(e.$slots,"default",{item:e.items[n],column:t,row:l,index:n},(()=>[f(p(e.items[n]),1)]))])})),128))],12,h)))),128))],4))}}),x=(()=>{const e=y;return e.install=n=>{n.component("MasonryWall",e)},e})();export{x as R};
